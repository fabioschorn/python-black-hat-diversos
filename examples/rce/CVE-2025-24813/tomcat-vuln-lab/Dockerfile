FROM tomcat:9.0.85-jdk11
LABEL maintainer="fs09 <fabio.schorn@expertsonline.com.br>"

# Enable the HTTP PUT method (required for CVE-2025-24813)
RUN sed -i 's/readonly="true"/readonly="false"/' /usr/local/tomcat/webapps/manager/META-INF/context.xml || true

# Open up PUT/DELETE in the default servlet config
RUN sed -i 's/<servlet-name>default<\/servlet-name>/&\n<init-param>\n<param-name>readonly<\/param-name>\n<param-value>false<\/param-value>\n<\/init-param>/' /usr/local/tomcat/conf/web.xml

# Copy a dummy index page for visual confirmation (optional)
RUN echo "Tomcat vulnerable test container - CVE-2025-24813" > /usr/local/tomcat/webapps/ROOT/index.html

EXPOSE 8080